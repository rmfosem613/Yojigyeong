<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta lang="ko">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>메인 페이지</title>
    <link rel="stylesheet" type="text/css" href="./style.css">

    <!-- Semantic -->
    <link rel="stylesheet" type="text/css" href="semantic/semantic.min.css">
    <!--배경 색을 지정함-->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="semantic/semantic.min.js"></script>
    
    <!-- update the version number as needed -->
    <script defer src="/__/firebase/8.6.2/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/8.6.2/firebase-database.js"></script>
    
  </head>
  <body>
    <!-- 사이드 메뉴 -->
    <ul>
      <li><a class="home_btn" href="./index.html"><img src="./image/earth-globe.png"
                  style="margin-right: 13px; height: 35px;">요<span style="color: #F17F42;">지</span>경</a></li>
      <hr style="margin-top: 15px; margin-left: 20px; margin-right: 30px;">

      <!-- 검색 -->
      <div class="ui search" style="margin-top: 20px; margin-left: 20px;">
          <div class="ui icon input">
              <input class="prompt" type="text" placeholder="나라 검색">
              <i class="search icon"></i>
          </div>
          <div class="results"></div>
      </div>

      <li><a class="vaccine_btn" href="#"><img src="./image/syringe.png" style="margin-right: 12px; height: 25px;">백신
              정보</a></li>
      <li><a class="flight_btn" href="#"><img src="./image/airplane.png" style="margin-right: 10px; height: 28px;">운항
              정보</a></li>
      <li><a class="recent_btn" href="./recent.html"><img src="./image/earth.png" style="margin-right: 15px; height: 22px;">나라별 최신
              정보</a></li>
  </ul>

    <div id="wrap">
      <div class="ui modal">
        <i class="close icon"></i>
        <div class="header">
          나라 정보
        </div>
        <div class="content">
          <div class="description" id="jsonModal">
          </div>
        </div>
        <div class="actions">
          <div class="ui black button">
            확인
          </div>
        </div>
      </div>
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
      <script src="node_modules/datamaps/dist/datamaps.world.min.js"></script>
      <div id="container" style="position: relative; width: 500px; height: 300px;"></div>
      <script>
        var map = new Datamap({
            element: document.getElementById('container'),
            fills: {
                HIGH: '#FFEEE4',
                LOW: '#FFEEE4',
                MEDIUM: '#F17F42',
                UNKNOWN: 'rgb(0,0,0)',
                defaultFill: '#8B8B8B'
            },
            // 하이라이트
            geographyConfig: {
                highlightFillColor: '#FFEEE4',
                highlightBorderColor: '#CE6D39'
            },
            // 클릭 이벤트?
            done: function(datamap) {
              datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
                 $.getJSON('./Json/recentNews.json', function (json) {
                  var countContent = 0;
                  for (var counter = 0; counter < json.length; counter++) {  //헤더, 최신 타이틀, 업데이트 날짜
                    if(geography.properties.name == json[counter].countryEnName){
                      $('#jsonModal').append('<div class="ui header" id="pre"> - ' + json[counter].countryName + '</div>');
                      $('#jsonModal').append('<p id="pre"> <b>최신 타이틀 : </b>' + json[counter].title +"</p>");
                      $('#jsonModal').append('<p id="pre"> <b>업데이트 날짜 : </b>' + json[counter].wrtDt +"</p>");
                      break;
                    }
                  }
                  for (var counter = 0; counter < json.length; counter++) {
                    if(geography.properties.name == json[counter].countryEnName){
                      countContent += 1;
                    }
                  }
                  $('#jsonModal').append('<p id="pre"> <b>게시글 수 : </b>' + countContent + "</p>");
                  $('.ui.modal')
                  .modal('attach events', '.black.button')  // '확인' 버튼 동작
                  .modal('show');
                });
                $('p').remove('#pre');
                $('div').remove('#pre');
              });
            }
        });
    </script>   
    </div>
    
  </body>
</html>
